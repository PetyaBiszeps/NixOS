# AGENTS.md

This file provides guidance to OpenAI Codex when working with code in this repository.

## Repository Overview

This repository is a NixOS configuration, designed for a simplified installation process with sensible defaults.

## Common Development Commands

### Building and Deployment
```bash
# Build and switch configuration
sudo nixos-rebuild switch --flake .#HOSTNAME

# Build without switching (testing)
sudo nixos-rebuild build --flake .#HOSTNAME

# Show detailed error trace
sudo nixos-rebuild build --flake .#HOSTNAME --show-trace

# Update flake inputs (if you need to update packages to latest versions)
nix flake update

# Clean up old generations (to free up disk space)
sudo nix-collect-garbage -d
```

### Git Workflow
```bash
# Check current branch
git branch

# Commit changes
git add .
git commit -m 'description'

# Push to repository
git push origin BRANCH-NAME
```

## Do's and Don'ts
- Don't add unnecessary dependencies
- Don't modify core system files without understanding their purpose
- Don't add code that doesn't serve a purpose for the current task
- Don't add anything extra without asking first
- Do test changes before committing
- Do keep the configuration user-friendly for me (as a newbie)

## Repository Information
**GitHub Repository**: https://github.com/PetyaBiszeps/NixOS

### Branch Strategy
- **niri-default**: Our branch we're working in

## Architecture Overview

### Key Design Principles
- **Simple Installation**: minimal questions, sensible defaults
- **Gaming Optimized**: Pre-configured for performance (Steam, GameMode, etc.)
- **Development Ready**: Optimized for JS/TS and web workflows
- **Default GUI**: it made to work with Niri as default GUI
- **Modular Features**: Decoupled modules for easy toggling
- **Newcomer Friendly**: Great defaults that work out of the box

### Key Directories
- `hosts/`: Host-specific configurations (hardware.nix, variables.nix, etc.)
- `modules/core`: Core system configuration modules
- `modules/drivers/`: Hardware driver configurations (NVIDIA, AMD, INTEL)
- `modules/home/`: Home-manager user environment configs
- `modules/home/niri/`: Niri configuration
- `profiles/`: Hardware-specific profiles that import appropriate modules
- `wallpapers/`: System wallpapers for theming

### Configuration Flow
1. `flake.nix` defines hosts and their profiles
2. Profiles import appropriate driver and core modules
3. Host directories contain hardware-specific settings
4. `variables.nix` in each host defines customization options

### Host Configuration Structure
Each host under `hosts/` contains:
- `default.nix`: Imports hardware.nix and host-packages.nix
- `hardware.nix`: Generated by nixos-generate-config, hardware-specific settings
- `variables.nix`: Host-specific variables (monitors, GPY IDs, preferences, feature toggles)
- `host-packages.nix`: Host-specific package installations

## Key Configuration Files

### Host Variables (`hosts/*/variables.nix`)
Important settings to understand when working with host configurations:

